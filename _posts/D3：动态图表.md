---
layout: post
title: D3.js 动态图表
subtitle: D3.js
author: oliver
header-img: img/post-bg-js-version.jpg
catalog: true
tags:
    - D3.js
---
# 什么是动态效果
动态的图表，是指图表在某一时间段会发生某种变化，可能是形状、颜色、位置等，而且用户是可以看到变化的过程的。

例如，有一个圆，圆心为 (100, 100)。现在我们希望圆的 x 坐标**从 100 移到 300**，并且移动过程在 2 秒的时间内发生。

这种时候就需要用到动态效果，在 D3 里我们称之为**过渡（transition）**。

# 实现动态的方法
D3 提供了 4 个方法用于实现图形的过渡：从状态 A 变为状态 B
## transition()
启动过渡效果。

其前后是图形变化前后的状态（形状、位置、颜色等等），例如：
```
.attr("fill","red")         //初始颜色为红色
.transition()               //启动过渡
.attr("fill","steelblue")   //终止颜色为铁蓝色
```
**D3 会自动对两种颜色（红色和铁蓝色）之间的颜色值（RGB值）进行插值计算**，得到过渡用的颜色值。我们无需知道中间是怎么计算的，只需要享受结果即可。

## duration()
指定过渡的持续时间，单位是毫秒

如duration(2000)，指持续2000毫秒，即2秒。

## ease()
指定过渡的方式，常用的有：
- linear：普通的线性变化
- circle：慢慢地到达变换的最终状态
- elastic：带有弹跳的到达最终状态
- bounce：在最终状态处弹跳几次

调用时，格式：ease("bounce")

## delay()
指定延迟的时间，表示一定时间后才开始转变，单位同样为毫秒。此函数可以对整体指定延迟，**也可以对个别指定延迟**。

例如，对整体指定时：
```
.transition()
.duration(1000)
.delay(500)
```
如此，图形整体在延迟 500 毫秒后发生变化，变化的时长为 1000 毫秒。因此，过渡的总时长为1500毫秒

**又如**，对一个一个的图形（图形上绑定了数据）进行指定时：
```
.transition()
.duration(1000)
.delay(funtion(d,i){
    return 200*i;
})
```